apiVersion: v1
kind: Pod
metadata:
  name: lidarr-migration-v3
  namespace: media
spec:
  containers:
    - name: migration
      image: alpine:latest
      command: ["/bin/sh", "-c", "apk add --no-cache rsync sqlite; sleep 3600"]
      volumeMounts:
        - name: old-config
          mountPath: /mnt/old
        - name: new-config
          mountPath: /mnt/new
  volumes:
    - name: old-config
      persistentVolumeClaim:
        claimName: lidarr-nfs-v2
    - name: new-config
      persistentVolumeClaim:
        claimName: lidarr-nfs-v3
  restartPolicy: Never
